{"openapi":"3.0.0","paths":{"/":{"get":{"operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":""}},"tags":["App"]}},"/config/info":{"get":{"operationId":"AppController_getConfigInfo","parameters":[],"responses":{"200":{"description":""}},"tags":["App"]}},"/auth/login":{"post":{"operationId":"AuthController_login","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"200":{"description":"Login realizado com sucesso","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponseDto"}}}},"401":{"description":"Credenciais inválidas"}},"summary":"Login de usuário","tags":["auth"]}},"/auth/me":{"get":{"operationId":"AuthController_getProfile","parameters":[],"responses":{"200":{"description":"Informações do usuário"},"401":{"description":"Não autorizado"}},"security":[{"bearer":[]}],"summary":"Obter informações do usuário autenticado","tags":["auth"]}},"/auth/logout":{"post":{"operationId":"AuthController_logout","parameters":[],"responses":{"200":{"description":"Logout realizado com sucesso"}},"security":[{"bearer":[]}],"summary":"Logout do usuário","tags":["auth"]}},"/users":{"post":{"operationId":"UserController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserDto"}}}},"responses":{"201":{"description":"Usuário criado com sucesso"},"400":{"description":"Dados inválidos"},"403":{"description":"Acesso negado"},"409":{"description":"Email ou CNPJ já cadastrado"}},"security":[{"bearer":[]}],"summary":"Criar novo usuário (Admin/Gestor)","tags":["users"]},"get":{"operationId":"UserController_findAll","parameters":[{"name":"role","required":false,"in":"query","description":"Filtrar por role","schema":{"type":"string"}},{"name":"search","required":false,"in":"query","description":"Buscar por nome ou email","schema":{"type":"string"}}],"responses":{"200":{"description":"Lista de usuários"},"403":{"description":"Acesso negado"}},"security":[{"bearer":[]}],"summary":"Listar todos os usuários","tags":["users"]}},"/users/stats":{"get":{"operationId":"UserController_getUserStats","parameters":[],"responses":{"200":{"description":"Estatísticas de usuários"},"403":{"description":"Acesso negado"}},"security":[{"bearer":[]}],"summary":"Obter estatísticas de usuários","tags":["users"]}},"/users/{id}":{"get":{"operationId":"UserController_findOne","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Usuário encontrado"},"403":{"description":"Acesso negado"},"404":{"description":"Usuário não encontrado"}},"security":[{"bearer":[]}],"summary":"Obter usuário por ID","tags":["users"]},"patch":{"operationId":"UserController_update","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserDto"}}}},"responses":{"200":{"description":"Usuário atualizado com sucesso"},"403":{"description":"Acesso negado"},"404":{"description":"Usuário não encontrado"},"409":{"description":"Email já cadastrado"}},"security":[{"bearer":[]}],"summary":"Atualizar usuário (Admin/Gestor)","tags":["users"]},"delete":{"operationId":"UserController_remove","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Usuário deletado com sucesso"},"403":{"description":"Acesso negado"},"404":{"description":"Usuário não encontrado"}},"security":[{"bearer":[]}],"summary":"Deletar usuário (Admin apenas)","tags":["users"]}},"/requests":{"post":{"operationId":"RequestController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateRequestDto"}}}},"responses":{"201":{"description":"Request created successfully (status: rascunho)"},"400":{"description":"Invalid industrial classification"},"404":{"description":"Company not found"}},"security":[{"bearer":[]}],"summary":"Create new certification request","tags":["Requests"]},"get":{"operationId":"RequestController_findAll","parameters":[{"name":"status","required":false,"in":"query","description":"Filter by status","schema":{"enum":["rascunho","enviado","pendente","em_analise","aprovado","rejeitado","cancelado"],"type":"string"}},{"name":"requestType","required":false,"in":"query","description":"Filter by request type","schema":{"enum":["nova","renovacao","ampliacao","inicial"],"type":"string"}},{"name":"certificationType","required":false,"in":"query","description":"Filter by certification type","schema":{"enum":["C1","C2","C3","C4","C5","C6","produto","processo","servico"],"type":"string"}},{"name":"companyId","required":false,"in":"query","description":"Filter by company ID","schema":{"format":"uuid","type":"string"}},{"name":"companyName","required":false,"in":"query","description":"Search by company name","schema":{"example":"Halal Foods","type":"string"}},{"name":"protocol","required":false,"in":"query","description":"Search by protocol number","schema":{"example":"REQ-20260115-00001","type":"string"}},{"name":"skip","required":false,"in":"query","description":"Pagination offset (default: 0)","schema":{"minimum":0,"default":0,"example":0,"type":"number"}},{"name":"take","required":false,"in":"query","description":"Items per page (default: 50)","schema":{"minimum":1,"default":50,"example":50,"type":"number"}}],"responses":{"200":{"description":"Paginated requests list"}},"security":[{"bearer":[]}],"summary":"List all certification requests with filters","tags":["Requests"]}},"/requests/{id}":{"patch":{"operationId":"RequestController_update","parameters":[{"name":"id","required":true,"in":"path","description":"Request ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateRequestDto"}}}},"responses":{"200":{"description":"Request updated"},"400":{"description":"Can only update draft requests"},"404":{"description":"Request not found"}},"security":[{"bearer":[]}],"summary":"Update certification request (draft only)","tags":["Requests"]},"get":{"operationId":"RequestController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Request ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Request found"},"404":{"description":"Request not found"}},"security":[{"bearer":[]}],"summary":"Get certification request by ID","tags":["Requests"]},"delete":{"operationId":"RequestController_cancel","parameters":[{"name":"id","required":true,"in":"path","description":"Request ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Request cancelled"},"400":{"description":"Cannot cancel approved or rejected requests"},"404":{"description":"Request not found"}},"security":[{"bearer":[]}],"summary":"Cancel certification request","tags":["Requests"]}},"/requests/{id}/submit":{"patch":{"operationId":"RequestController_submit","parameters":[{"name":"id","required":true,"in":"path","description":"Request ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Request submitted (status: pendente, protocol generated)"},"400":{"description":"Can only submit draft requests"},"404":{"description":"Request not found"}},"security":[{"bearer":[]}],"summary":"Submit request for analysis (generates protocol)","tags":["Requests"]}},"/requests/{id}/start-review":{"patch":{"operationId":"RequestController_startReview","parameters":[{"name":"id","required":true,"in":"path","description":"Request ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Request review started (status: em_analise)"},"400":{"description":"Can only review pending requests"},"404":{"description":"Request not found"}},"security":[{"bearer":[]}],"summary":"Start request review","tags":["Requests"]}},"/requests/{id}/approve":{"patch":{"operationId":"RequestController_approve","parameters":[{"name":"id","required":true,"in":"path","description":"Request ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApproveRequestDto"}}}},"responses":{"200":{"description":"Request approved, Process created"},"400":{"description":"Can only approve requests under analysis"},"404":{"description":"Request not found"}},"security":[{"bearer":[]}],"summary":"Approve request (creates Process automatically)","tags":["Requests"]}},"/requests/{id}/reject":{"patch":{"operationId":"RequestController_reject","parameters":[{"name":"id","required":true,"in":"path","description":"Request ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RejectRequestDto"}}}},"responses":{"200":{"description":"Request rejected"},"400":{"description":"Can only reject requests under analysis"},"404":{"description":"Request not found"}},"security":[{"bearer":[]}],"summary":"Reject request","tags":["Requests"]}},"/requests/company/{companyId}":{"get":{"operationId":"RequestController_findByCompany","parameters":[{"name":"companyId","required":true,"in":"path","description":"Company ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Company requests found"}},"security":[{"bearer":[]}],"summary":"Get company's certification requests","tags":["Requests"]}},"/requests/protocol/{protocol}":{"get":{"operationId":"RequestController_findByProtocol","parameters":[{"name":"protocol","required":true,"in":"path","description":"Protocol number (e.g., REQ-20260115-00001)","schema":{"type":"string"}}],"responses":{"200":{"description":"Request found"},"404":{"description":"Request not found"}},"security":[{"bearer":[]}],"summary":"Get request by protocol number","tags":["Requests"]}},"/requests/stats/summary":{"get":{"operationId":"RequestController_getStats","parameters":[],"responses":{"200":{"description":"Statistics including total, by status, by type, avg review time"}},"security":[{"bearer":[]}],"summary":"Get certification request statistics","tags":["Requests"]}},"/companies":{"post":{"description":"Register a new company with CNPJ validation. CNPJ must be unique.","operationId":"CompanyController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCompanyDto"}}}},"responses":{"201":{"description":"Company registered successfully"},"400":{"description":"Invalid CNPJ format"},"409":{"description":"CNPJ already registered"}},"security":[{"bearer":[]}],"summary":"Register new company","tags":["Companies"]},"get":{"description":"List companies with optional filters and pagination","operationId":"CompanyController_findAll","parameters":[{"name":"isActive","required":false,"in":"query","description":"Filter by active status","schema":{"example":true,"type":"boolean"}},{"name":"isVerified","required":false,"in":"query","description":"Filter by verification status","schema":{"example":true,"type":"boolean"}},{"name":"cidade","required":false,"in":"query","description":"Filter by city","schema":{"example":"São Paulo","type":"string"}},{"name":"estado","required":false,"in":"query","description":"Filter by state","schema":{"example":"SP","type":"string"}},{"name":"pais","required":false,"in":"query","description":"Filter by country","schema":{"example":"Brasil","type":"string"}},{"name":"search","required":false,"in":"query","description":"Search by company name or CNPJ","schema":{"example":"Halal","type":"string"}},{"name":"skip","required":false,"in":"query","description":"Pagination offset","schema":{"minimum":0,"default":0,"example":0,"type":"number"}},{"name":"take","required":false,"in":"query","description":"Items per page","schema":{"minimum":1,"default":50,"example":50,"type":"number"}}],"responses":{"200":{"description":"Companies retrieved successfully"}},"security":[{"bearer":[]}],"summary":"List companies","tags":["Companies"]}},"/companies/{id}":{"get":{"description":"Get company details including verifier information and related entity counts","operationId":"CompanyController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Company UUID","schema":{"example":"550e8400-e29b-41d4-a716-446655440000","type":"string"}}],"responses":{"200":{"description":"Company found"},"404":{"description":"Company not found"}},"security":[{"bearer":[]}],"summary":"Get company by ID","tags":["Companies"]},"patch":{"description":"Update company details. CNPJ cannot be changed. Company must be active.","operationId":"CompanyController_update","parameters":[{"name":"id","required":true,"in":"path","description":"Company UUID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateCompanyDto"}}}},"responses":{"200":{"description":"Company updated successfully"},"400":{"description":"Company is inactive"},"404":{"description":"Company not found"}},"security":[{"bearer":[]}],"summary":"Update company","tags":["Companies"]},"delete":{"description":"Deactivate company (soft delete). Cannot delete if company has active processes.","operationId":"CompanyController_softDelete","parameters":[{"name":"id","required":true,"in":"path","description":"Company UUID","schema":{"type":"string"}}],"responses":{"200":{"description":"Company deactivated successfully"},"400":{"description":"Company already inactive or has active processes"},"404":{"description":"Company not found"}},"security":[{"bearer":[]}],"summary":"Soft delete company (admin only)","tags":["Companies"]}},"/companies/cnpj/{cnpj}":{"get":{"description":"Find company using CNPJ (Brazilian tax ID)","operationId":"CompanyController_findByCnpj","parameters":[{"name":"cnpj","required":true,"in":"path","description":"Company CNPJ (format: XX.XXX.XXX/XXXX-XX)","schema":{"example":"12.345.678/0001-90","type":"string"}}],"responses":{"200":{"description":"Company found"},"404":{"description":"Company not found"}},"security":[{"bearer":[]}],"summary":"Get company by CNPJ","tags":["Companies"]}},"/companies/{id}/verify":{"patch":{"description":"Mark company as verified. Records admin who verified and timestamp.","operationId":"CompanyController_verify","parameters":[{"name":"id","required":true,"in":"path","description":"Company UUID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyCompanyDto"}}}},"responses":{"200":{"description":"Company verified successfully"},"400":{"description":"Company already verified or inactive"},"404":{"description":"Company not found"}},"security":[{"bearer":[]}],"summary":"Verify company (admin only)","tags":["Companies"]}},"/companies/{id}/unverify":{"patch":{"description":"Remove verification status from company","operationId":"CompanyController_unverify","parameters":[{"name":"id","required":true,"in":"path","description":"Company UUID","schema":{"type":"string"}}],"responses":{"200":{"description":"Verification removed successfully"},"400":{"description":"Company is not verified"},"404":{"description":"Company not found"}},"security":[{"bearer":[]}],"summary":"Remove company verification (admin only)","tags":["Companies"]}},"/companies/{id}/reactivate":{"patch":{"description":"Reactivate a previously deactivated company","operationId":"CompanyController_reactivate","parameters":[{"name":"id","required":true,"in":"path","description":"Company UUID","schema":{"type":"string"}}],"responses":{"200":{"description":"Company reactivated successfully"},"400":{"description":"Company is already active"},"404":{"description":"Company not found"}},"security":[{"bearer":[]}],"summary":"Reactivate company (admin only)","tags":["Companies"]}},"/companies/search/query":{"get":{"description":"Search companies by name or CNPJ with fuzzy matching. Returns max 20 results.","operationId":"CompanyController_search","parameters":[{"name":"query","required":true,"in":"query","description":"Search query (min 2 characters)","schema":{"minLength":2,"example":"Halal","type":"string"}}],"responses":{"200":{"description":"Search results"}},"security":[{"bearer":[]}],"summary":"Quick search companies","tags":["Companies"]}},"/companies/stats/summary":{"get":{"description":"Get comprehensive statistics including totals, status counts, and geographic distribution","operationId":"CompanyController_getStats","parameters":[],"responses":{"200":{"description":"Statistics retrieved successfully"}},"security":[{"bearer":[]}],"summary":"Get company statistics (admin only)","tags":["Companies"]}},"/processes":{"post":{"description":"Cria um novo processo de certificação com dados do wizard multi-step","operationId":"ProcessController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateProcessDto"}}}},"responses":{"201":{"description":"Processo criado com sucesso"},"400":{"description":"Dados inválidos"},"404":{"description":"Empresa não encontrada"}},"security":[{"bearer":[]}],"summary":"Criar novo processo de certificação (Empresa)","tags":["processes"]},"get":{"description":"Lista processos com filtros baseados no role do usuário:\n- empresa: apenas seus próprios processos\n- analista: processos atribuídos a ele\n- gestor/admin: todos os processos com filtros opcionais","operationId":"ProcessController_findAll","parameters":[{"name":"priority","required":false,"in":"query","description":"Filtrar por prioridade (gestor/admin apenas)","schema":{"enum":["baixa","media","alta","urgente"],"type":"string"}},{"name":"phase","required":false,"in":"query","description":"Filtrar por fase (gestor/admin apenas)","schema":{"enum":["cadastro_solicitacao","analise_documental_inicial","elaboracao_proposta","negociacao_proposta","proposta_aprovada","elaboracao_contrato","assinatura_contrato","avaliacao_documental","planejamento_auditoria","auditoria_estagio1","auditoria_estagio2","analise_nao_conformidades","correcao_nao_conformidades","validacao_correcoes","comite_tecnico","emissao_certificado","certificado_emitido"],"type":"string"}},{"name":"status","required":false,"in":"query","description":"Filtrar por status (gestor/admin apenas)","schema":{"enum":["rascunho","pendente","em_andamento","aguardando_documentos","analise_documental","analise_tecnica","aguardando_auditoria","proposta_enviada","aguardando_assinatura","em_auditoria","concluido","aprovado","reprovado","certificado","cancelado","suspenso"],"type":"string"}}],"responses":{"200":{"description":"Lista de processos retornada com sucesso"}},"security":[{"bearer":[]}],"summary":"Listar processos","tags":["processes"]}},"/processes/{id}":{"get":{"description":"Retorna detalhes completos do processo.\nAuto-assign: Se analista abrir processo pendente sem analista, será automaticamente atribuído.","operationId":"ProcessController_findOne","parameters":[{"name":"id","required":true,"in":"path","description":"ID do processo","schema":{"type":"string"}}],"responses":{"200":{"description":"Detalhes do processo"},"404":{"description":"Processo não encontrado"}},"security":[{"bearer":[]}],"summary":"Obter detalhes do processo","tags":["processes"]}},"/processes/{id}/submit":{"post":{"description":"Submete o processo de rascunho para pendente, disponibilizando para atribuição de analista","operationId":"ProcessController_submitWizard","parameters":[{"name":"id","required":true,"in":"path","description":"ID do processo","schema":{"type":"string"}}],"responses":{"200":{"description":"Processo submetido com sucesso"},"400":{"description":"Processo já foi submetido"},"403":{"description":"Acesso negado a este processo"},"404":{"description":"Processo não encontrado"}},"security":[{"bearer":[]}],"summary":"Submeter processo (Empresa)","tags":["processes"]}},"/processes/{id}/status":{"patch":{"description":"Atualiza o status do processo com validação de permissões.\nCria registro de histórico e sincroniza com Request.","operationId":"ProcessController_updateStatus","parameters":[{"name":"id","required":true,"in":"path","description":"ID do processo","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProcessStatusDto"}}}},"responses":{"200":{"description":"Status atualizado com sucesso"},"403":{"description":"Usuário não pode atuar nesta fase"},"404":{"description":"Processo não encontrado"}},"security":[{"bearer":[]}],"summary":"Atualizar status do processo (Analista/Gestor/Auditor)","tags":["processes"]}},"/processes/{id}/assign":{"post":{"description":"Atribui analista ao processo e avança automaticamente para fase de análise documental inicial.\nCria registro de histórico de fase.","operationId":"ProcessController_assignAnalyst","parameters":[{"name":"id","required":true,"in":"path","description":"ID do processo","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AssignAnalystDto"}}}},"responses":{"200":{"description":"Analista atribuído com sucesso"},"400":{"description":"Usuário não possui role de analista ou gestor"},"404":{"description":"Processo ou analista não encontrado"}},"security":[{"bearer":[]}],"summary":"Atribuir analista ao processo (Gestor)","tags":["processes"]}},"/processes/{id}/advance-phase":{"post":{"description":"Avança o processo para a próxima fase com validação de regras.\nValida se todas as condições da fase atual foram cumpridas.\nAtualiza status do processo e Request em transação atômica.","operationId":"ProcessController_advancePhase","parameters":[{"name":"id","required":true,"in":"path","description":"ID do processo","schema":{"type":"string"}},{"name":"notes","required":false,"in":"query","description":"Notas sobre o avanço de fase","schema":{}}],"responses":{"200":{"description":"Fase avançada com sucesso"},"400":{"description":"Não é possível avançar para próxima fase (validação falhou)"},"403":{"description":"Usuário não pode avançar esta fase"},"404":{"description":"Processo não encontrado"}},"security":[{"bearer":[]}],"summary":"Avançar para próxima fase (Analista/Gestor/Auditor)","tags":["processes"]}},"/proposals":{"post":{"operationId":"ProposalController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateProposalDto"}}}},"responses":{"201":{"description":"Proposal created successfully"},"400":{"description":"Process already has a proposal"},"404":{"description":"Process not found"}},"security":[{"bearer":[]}],"summary":"Create new proposal for a process","tags":["Proposals"]},"get":{"operationId":"ProposalController_findAll","parameters":[{"name":"status","required":false,"in":"query","description":"Filter by status","schema":{"enum":["rascunho","calculada","enviada","aceita","recusada","expirada"],"type":"string"}},{"name":"createdBy","required":false,"in":"query","description":"Filter by creator user ID","schema":{"type":"string"}},{"name":"skip","required":false,"in":"query","description":"Pagination offset (default: 0)","schema":{"type":"number"}},{"name":"take","required":false,"in":"query","description":"Items per page (default: 50)","schema":{"type":"number"}}],"responses":{"200":{"description":"Paginated proposals list"}},"security":[{"bearer":[]}],"summary":"Get all proposals with optional filters","tags":["Proposals"]}},"/proposals/calculate":{"post":{"operationId":"ProposalController_calculate","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CalculationInputDto"}}}},"responses":{"200":{"description":"Calculation breakdown returned"}},"security":[{"bearer":[]}],"summary":"Calculate proposal values without saving (preview)","tags":["Proposals"]}},"/proposals/{id}/recalculate":{"patch":{"operationId":"ProposalController_recalculate","parameters":[{"name":"id","required":true,"in":"path","description":"Proposal ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CalculationInputDto"}}}},"responses":{"200":{"description":"Proposal recalculated"},"400":{"description":"Cannot recalculate accepted/rejected proposal"},"404":{"description":"Proposal not found"}},"security":[{"bearer":[]}],"summary":"Recalculate proposal with new inputs","tags":["Proposals"]}},"/proposals/{id}/adjust":{"patch":{"operationId":"ProposalController_adjust","parameters":[{"name":"id","required":true,"in":"path","description":"Proposal ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdjustProposalDto"}}}},"responses":{"200":{"description":"Adjustment applied (may include warning if >20%)"},"400":{"description":"Cannot adjust accepted/rejected proposal"},"404":{"description":"Proposal not found"}},"security":[{"bearer":[]}],"summary":"Apply manual adjustment to proposal value","tags":["Proposals"]}},"/proposals/{id}/send":{"patch":{"operationId":"ProposalController_send","parameters":[{"name":"id","required":true,"in":"path","description":"Proposal ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Proposal sent"},"400":{"description":"Can only send draft or calculated proposals"},"404":{"description":"Proposal not found"}},"security":[{"bearer":[]}],"summary":"Send proposal to company (sets 30-day expiration)","tags":["Proposals"]}},"/proposals/{id}/respond":{"patch":{"operationId":"ProposalController_respond","parameters":[{"name":"id","required":true,"in":"path","description":"Proposal ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RespondProposalDto"}}}},"responses":{"200":{"description":"Response recorded, process advanced if accepted"},"400":{"description":"Can only respond to sent proposals / Proposal expired"},"404":{"description":"Proposal not found"}},"security":[{"bearer":[]}],"summary":"Company responds to proposal (accept/reject). If accepted, advances process to contract signing.","tags":["Proposals"]}},"/proposals/{id}":{"get":{"operationId":"ProposalController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Proposal ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Proposal found"},"404":{"description":"Proposal not found"}},"security":[{"bearer":[]}],"summary":"Get proposal by ID","tags":["Proposals"]}},"/proposals/process/{processId}":{"get":{"operationId":"ProposalController_findByProcessId","parameters":[{"name":"processId","required":true,"in":"path","description":"Process ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Proposal found or null"}},"security":[{"bearer":[]}],"summary":"Get proposal by process ID","tags":["Proposals"]}},"/proposals/check-expired":{"post":{"operationId":"ProposalController_checkExpired","parameters":[],"responses":{"200":{"description":"Number of proposals marked as expired"}},"security":[{"bearer":[]}],"summary":"Check and mark expired proposals (background job)","tags":["Proposals"]}},"/proposals/stats/summary":{"get":{"operationId":"ProposalController_getStats","parameters":[],"responses":{"200":{"description":"Statistics including total, by status, avg/total value"}},"security":[{"bearer":[]}],"summary":"Get proposal statistics","tags":["Proposals"]}},"/proposals/pricing-tables":{"post":{"operationId":"ProposalController_createPricingTable","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePricingTableDto"}}}},"responses":{"201":{"description":"Pricing table created"},"400":{"description":"Version already exists"}},"security":[{"bearer":[]}],"summary":"Create new pricing table (auto-deactivates previous)","tags":["Proposals"]},"get":{"operationId":"ProposalController_findAllPricingTables","parameters":[{"name":"isActive","required":false,"in":"query","description":"Filter by active status","schema":{"type":"boolean"}},{"name":"skip","required":false,"in":"query","description":"Pagination offset","schema":{"type":"number"}},{"name":"take","required":false,"in":"query","description":"Items per page","schema":{"type":"number"}}],"responses":{"200":{"description":"Paginated pricing tables list"}},"security":[{"bearer":[]}],"summary":"Get all pricing tables with optional filters","tags":["Proposals"]}},"/proposals/pricing-tables/{id}":{"patch":{"operationId":"ProposalController_updatePricingTable","parameters":[{"name":"id","required":true,"in":"path","description":"Pricing table ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdatePricingTableDto"}}}},"responses":{"200":{"description":"New version created"},"404":{"description":"Pricing table not found"}},"security":[{"bearer":[]}],"summary":"Update pricing table (creates new version with incremented number)","tags":["Proposals"]},"get":{"operationId":"ProposalController_findPricingTableById","parameters":[{"name":"id","required":true,"in":"path","description":"Pricing table ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Pricing table found"},"404":{"description":"Pricing table not found"}},"security":[{"bearer":[]}],"summary":"Get pricing table by ID","tags":["Proposals"]}},"/proposals/pricing-tables/active":{"get":{"operationId":"ProposalController_findActivePricingTable","parameters":[],"responses":{"200":{"description":"Active pricing table"},"404":{"description":"No active table found"}},"security":[{"bearer":[]}],"summary":"Get active pricing table","tags":["Proposals"]}},"/proposals/pricing-tables/compare/{id1}/{id2}":{"get":{"operationId":"ProposalController_comparePricingTables","parameters":[{"name":"id1","required":true,"in":"path","description":"First pricing table ID","schema":{"type":"string"}},{"name":"id2","required":true,"in":"path","description":"Second pricing table ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Comparison with differences list"},"404":{"description":"One or both tables not found"}},"security":[{"bearer":[]}],"summary":"Compare two pricing table versions","tags":["Proposals"]}},"/audits":{"post":{"operationId":"AuditController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateAuditDto"}}}},"responses":{"201":{"description":"Audit created successfully"},"400":{"description":"Process not in auditoria phase"},"404":{"description":"Process not found"}},"security":[{"bearer":[]}],"summary":"Create new audit for a process","tags":["Audits"]},"get":{"operationId":"AuditController_findAll","parameters":[{"name":"status","required":false,"in":"query","description":"Filter by status","schema":{"enum":["agendado","em_andamento","concluido","cancelado"],"type":"string"}},{"name":"result","required":false,"in":"query","description":"Filter by result","schema":{"enum":["aprovado","aprovado_condicional","reprovado"],"type":"string"}},{"name":"skip","required":false,"in":"query","description":"Pagination offset (default: 0)","schema":{"type":"number"}},{"name":"take","required":false,"in":"query","description":"Items per page (default: 50)","schema":{"type":"number"}}],"responses":{"200":{"description":"Paginated audits list"}},"security":[{"bearer":[]}],"summary":"Get all audits with optional filters","tags":["Audits"]}},"/audits/{id}":{"patch":{"operationId":"AuditController_update","parameters":[{"name":"id","required":true,"in":"path","description":"Audit ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateAuditDto"}}}},"responses":{"200":{"description":"Audit updated"},"400":{"description":"Can only update scheduled audits"},"404":{"description":"Audit not found"}},"security":[{"bearer":[]}],"summary":"Update audit details (date, location, notes)","tags":["Audits"]},"delete":{"operationId":"AuditController_delete","parameters":[{"name":"id","required":true,"in":"path","description":"Audit ID","schema":{"type":"string"}}],"responses":{"204":{"description":"Audit deleted"},"400":{"description":"Can only delete scheduled or canceled audits"},"404":{"description":"Audit not found"}},"security":[{"bearer":[]}],"summary":"Delete an audit (only if agendado or cancelado)","tags":["Audits"]},"get":{"operationId":"AuditController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Audit ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Audit found"},"404":{"description":"Audit not found"}},"security":[{"bearer":[]}],"summary":"Get audit by ID","tags":["Audits"]}},"/audits/{id}/start":{"patch":{"operationId":"AuditController_start","parameters":[{"name":"id","required":true,"in":"path","description":"Audit ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StartAuditDto"}}}},"responses":{"200":{"description":"Audit started"},"400":{"description":"Can only start scheduled audits / Date not arrived"},"404":{"description":"Audit not found"}},"security":[{"bearer":[]}],"summary":"Start audit execution (agendado → em_andamento)","tags":["Audits"]}},"/audits/{id}/complete":{"patch":{"operationId":"AuditController_complete","parameters":[{"name":"id","required":true,"in":"path","description":"Audit ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompleteAuditDto"}}}},"responses":{"200":{"description":"Audit completed"},"400":{"description":"Can only complete in-progress audits"},"404":{"description":"Audit not found"}},"security":[{"bearer":[]}],"summary":"Complete audit with findings (em_andamento → concluido)","tags":["Audits"]}},"/audits/{id}/finalize":{"patch":{"operationId":"AuditController_finalize","parameters":[{"name":"id","required":true,"in":"path","description":"Audit ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FinalizeAuditDto"}}}},"responses":{"200":{"description":"Audit finalized, process advanced if approved"},"400":{"description":"Can only finalize completed audits / Already finalized"},"404":{"description":"Audit not found"}},"security":[{"bearer":[]}],"summary":"Finalize audit with decision (approve/reject). If approved, advances process to certificate issuance.","tags":["Audits"]}},"/audits/{id}/cancel":{"patch":{"operationId":"AuditController_cancel","parameters":[{"name":"id","required":true,"in":"path","description":"Audit ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelAuditDto"}}}},"responses":{"200":{"description":"Audit canceled"},"400":{"description":"Can only cancel scheduled audits"},"404":{"description":"Audit not found"}},"security":[{"bearer":[]}],"summary":"Cancel a scheduled audit","tags":["Audits"]}},"/audits/process/{processId}":{"get":{"operationId":"AuditController_findByProcessId","parameters":[{"name":"processId","required":true,"in":"path","description":"Process ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Audits found"}},"security":[{"bearer":[]}],"summary":"Get all audits for a process","tags":["Audits"]}},"/audits/upcoming":{"get":{"operationId":"AuditController_getUpcomingAudits","parameters":[{"name":"daysAhead","required":false,"in":"query","description":"Number of days ahead (default: 30)","schema":{"minimum":1,"example":30,"type":"number"}},{"name":"userRole","required":false,"in":"query","description":"User role for filtering","schema":{"example":"empresa","type":"string"}},{"name":"companyId","required":false,"in":"query","description":"Company ID for filtering (empresa role)","schema":{"example":"cluid123","type":"string"}}],"responses":{"200":{"description":"Upcoming audits"}},"security":[{"bearer":[]}],"summary":"Get upcoming audits scheduled in the next N days (default: 30)","tags":["Audits"]}},"/audits/by-status":{"get":{"operationId":"AuditController_findByStatus","parameters":[{"name":"status","required":true,"in":"query","description":"Audit status","schema":{"enum":["agendado","em_andamento","concluido","cancelado"],"type":"string"}},{"name":"userRole","required":false,"in":"query","description":"User role for filtering","schema":{"example":"empresa","type":"string"}},{"name":"companyId","required":false,"in":"query","description":"Company ID for filtering (empresa role)","schema":{"example":"cluid123","type":"string"}}],"responses":{"200":{"description":"Audits by status"}},"security":[{"bearer":[]}],"summary":"Get audits filtered by status","tags":["Audits"]}},"/audits/stats/summary":{"get":{"operationId":"AuditController_getStats","parameters":[],"responses":{"200":{"description":"Statistics including total, by status, by result, avg non-conformities"}},"security":[{"bearer":[]}],"summary":"Get audit statistics","tags":["Audits"]}},"/contracts":{"post":{"operationId":"ContractController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateContractDto"}}}},"responses":{"201":{"description":"Contract created successfully"},"400":{"description":"Process not in assinatura_contrato phase"},"404":{"description":"Process or company not found"},"409":{"description":"Contract already exists for this process"}},"security":[{"bearer":[]}],"summary":"Create new contract for a process","tags":["Contracts"]},"get":{"operationId":"ContractController_findAll","parameters":[{"name":"status","required":false,"in":"query","description":"Filter by status","schema":{"enum":["rascunho","enviado","em_negociacao","assinado","cancelado"],"type":"string"}},{"name":"contractType","required":false,"in":"query","description":"Filter by type","schema":{"enum":["proposta","contrato"],"type":"string"}},{"name":"processId","required":false,"in":"query","description":"Filter by process ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174000","type":"string"}},{"name":"companyId","required":false,"in":"query","description":"Filter by company ID","schema":{"example":"123e4567-e89b-12d3-a456-426614174001","type":"string"}},{"name":"skip","required":false,"in":"query","description":"Pagination offset (default: 0)","schema":{"minimum":0,"example":0,"type":"number"}},{"name":"take","required":false,"in":"query","description":"Items per page (default: 50)","schema":{"minimum":1,"example":50,"type":"number"}}],"responses":{"200":{"description":"Paginated contracts list"}},"security":[{"bearer":[]}],"summary":"Get all contracts with optional filters","tags":["Contracts"]}},"/contracts/{id}":{"patch":{"operationId":"ContractController_update","parameters":[{"name":"id","required":true,"in":"path","description":"Contract ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateContractDto"}}}},"responses":{"200":{"description":"Contract updated"},"400":{"description":"Can only update draft contracts"},"404":{"description":"Contract not found"}},"security":[{"bearer":[]}],"summary":"Update contract details (only draft contracts)","tags":["Contracts"]},"get":{"operationId":"ContractController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Contract ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Contract found"},"404":{"description":"Contract not found"}},"security":[{"bearer":[]}],"summary":"Get contract by ID","tags":["Contracts"]}},"/contracts/process/{processId}":{"get":{"operationId":"ContractController_findByProcessId","parameters":[{"name":"processId","required":true,"in":"path","description":"Process ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Contract found or null"}},"security":[{"bearer":[]}],"summary":"Get contract by process ID","tags":["Contracts"]}},"/contracts/{id}/send":{"patch":{"operationId":"ContractController_send","parameters":[{"name":"id","required":true,"in":"path","description":"Contract ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Contract sent"},"400":{"description":"Can only send draft contracts"},"404":{"description":"Contract not found"}},"security":[{"bearer":[]}],"summary":"Send contract to company (rascunho → enviado)","tags":["Contracts"]}},"/contracts/{id}/negotiate":{"patch":{"operationId":"ContractController_negotiate","parameters":[{"name":"id","required":true,"in":"path","description":"Contract ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Contract marked as negotiating"},"400":{"description":"Can only negotiate sent contracts"},"404":{"description":"Contract not found"}},"security":[{"bearer":[]}],"summary":"Mark contract as in negotiation (enviado → em_negociacao)","tags":["Contracts"]}},"/contracts/{id}/sign":{"patch":{"operationId":"ContractController_sign","parameters":[{"name":"id","required":true,"in":"path","description":"Contract ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignContractDto"}}}},"responses":{"200":{"description":"Contract signed, process advanced to audit planning"},"400":{"description":"Can only sign sent or negotiating contracts"},"404":{"description":"Contract not found"}},"security":[{"bearer":[]}],"summary":"Sign contract (enviado/em_negociacao → assinado). Advances process to planejamento_auditoria.","tags":["Contracts"]}},"/contracts/{id}/cancel":{"patch":{"operationId":"ContractController_cancel","parameters":[{"name":"id","required":true,"in":"path","description":"Contract ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelContractDto"}}}},"responses":{"200":{"description":"Contract cancelled"},"400":{"description":"Cannot cancel signed contracts"},"404":{"description":"Contract not found"}},"security":[{"bearer":[]}],"summary":"Cancel contract. Cannot cancel signed contracts.","tags":["Contracts"]}},"/contracts/stats/summary":{"get":{"operationId":"ContractController_getStats","parameters":[],"responses":{"200":{"description":"Statistics including total, by status, total value, avg signing time"}},"security":[{"bearer":[]}],"summary":"Get contract statistics","tags":["Contracts"]}},"/document-requests":{"post":{"operationId":"DocumentRequestController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateDocumentRequestDto"}}}},"responses":{"201":{"description":"Document request created successfully"},"404":{"description":"Process not found"}},"security":[{"bearer":[]}],"summary":"Create new document request for a process","tags":["Document Requests"]},"get":{"operationId":"DocumentRequestController_findAll","parameters":[{"name":"processId","required":false,"in":"query","description":"Filter by process ID","schema":{"type":"string"}},{"name":"status","required":false,"in":"query","description":"Filter by status","schema":{"enum":["pendente","atendido","cancelado"],"type":"string"}},{"name":"documentType","required":false,"in":"query","description":"Filter by document type","schema":{"enum":["contrato_social","certidao_negativa","alvara_funcionamento","laudo_tecnico","licenca_sanitaria","fotos","videos","laudos","manual_bpf","fluxograma_processo","lista_fornecedores","certificado_ingredientes","analise_produto","rotulo_produto","outros"],"type":"string"}},{"name":"overdue","required":false,"in":"query","description":"Filter overdue requests","schema":{"type":"boolean"}},{"name":"skip","required":false,"in":"query","description":"Pagination offset (default: 0)","schema":{"minimum":0,"type":"number"}},{"name":"take","required":false,"in":"query","description":"Items per page (default: 50)","schema":{"minimum":1,"type":"number"}}],"responses":{"200":{"description":"Paginated document requests list"}},"security":[{"bearer":[]}],"summary":"Get all document requests with optional filters","tags":["Document Requests"]}},"/document-requests/{id}":{"patch":{"operationId":"DocumentRequestController_update","parameters":[{"name":"id","required":true,"in":"path","description":"Document request ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateDocumentRequestDto"}}}},"responses":{"200":{"description":"Document request updated"},"400":{"description":"Can only update pending requests"},"404":{"description":"Document request not found"}},"security":[{"bearer":[]}],"summary":"Update document request (only pending requests)","tags":["Document Requests"]},"get":{"operationId":"DocumentRequestController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Document request ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Document request found"},"404":{"description":"Document request not found"}},"security":[{"bearer":[]}],"summary":"Get document request by ID","tags":["Document Requests"]},"delete":{"operationId":"DocumentRequestController_delete","parameters":[{"name":"id","required":true,"in":"path","description":"Document request ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Document request deleted"},"404":{"description":"Document request not found"}},"security":[{"bearer":[]}],"summary":"Delete document request","tags":["Document Requests"]}},"/document-requests/process/{processId}":{"get":{"operationId":"DocumentRequestController_findByProcessId","parameters":[{"name":"processId","required":true,"in":"path","description":"Process ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Document requests found"}},"security":[{"bearer":[]}],"summary":"Get all document requests for a process","tags":["Document Requests"]}},"/document-requests/{id}/fulfill":{"patch":{"operationId":"DocumentRequestController_fulfill","parameters":[{"name":"id","required":true,"in":"path","description":"Document request ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FulfillDocumentRequestDto"}}}},"responses":{"200":{"description":"Document request fulfilled successfully"},"400":{"description":"Can only fulfill pending requests"},"404":{"description":"Document request or document not found"}},"security":[{"bearer":[]}],"summary":"Fulfill document request by linking uploaded document (pendente → atendido)","tags":["Document Requests"]}},"/document-requests/{id}/cancel":{"patch":{"operationId":"DocumentRequestController_cancel","parameters":[{"name":"id","required":true,"in":"path","description":"Document request ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Document request cancelled"},"400":{"description":"Can only cancel pending requests"},"404":{"description":"Document request not found"}},"security":[{"bearer":[]}],"summary":"Cancel document request (pendente → cancelado)","tags":["Document Requests"]}},"/document-requests/process/{processId}/pending":{"get":{"operationId":"DocumentRequestController_findPendingByProcessId","parameters":[{"name":"processId","required":true,"in":"path","description":"Process ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Pending document requests found"}},"security":[{"bearer":[]}],"summary":"Get pending document requests for a process","tags":["Document Requests"]}},"/document-requests/overdue/all":{"get":{"operationId":"DocumentRequestController_findOverdue","parameters":[],"responses":{"200":{"description":"Overdue document requests found"}},"security":[{"bearer":[]}],"summary":"Get all overdue document requests","tags":["Document Requests"]}},"/comments":{"post":{"operationId":"CommentController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCommentDto"}}}},"responses":{"201":{"description":"Comment created successfully"},"404":{"description":"Process not found"}},"security":[{"bearer":[]}],"summary":"Create new comment on a process","tags":["Comments"]},"get":{"operationId":"CommentController_findAll","parameters":[{"name":"processId","required":false,"in":"query","description":"Filter by process ID","schema":{"type":"string"}},{"name":"userId","required":false,"in":"query","description":"Filter by user ID (author)","schema":{"type":"string"}},{"name":"isInternal","required":false,"in":"query","description":"Filter by internal flag","schema":{"type":"boolean"}},{"name":"mentioned","required":false,"in":"query","description":"Filter by mentioned user ID","schema":{"type":"string"}},{"name":"skip","required":false,"in":"query","description":"Pagination offset (default: 0)","schema":{"minimum":0,"type":"number"}},{"name":"take","required":false,"in":"query","description":"Items per page (default: 50)","schema":{"minimum":1,"type":"number"}}],"responses":{"200":{"description":"Paginated comments list"}},"security":[{"bearer":[]}],"summary":"Get all comments with optional filters","tags":["Comments"]}},"/comments/{id}":{"patch":{"operationId":"CommentController_update","parameters":[{"name":"id","required":true,"in":"path","description":"Comment ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateCommentDto"}}}},"responses":{"200":{"description":"Comment updated"},"403":{"description":"Not comment owner"},"404":{"description":"Comment not found"}},"security":[{"bearer":[]}],"summary":"Update comment (own comments only)","tags":["Comments"]},"delete":{"operationId":"CommentController_delete","parameters":[{"name":"id","required":true,"in":"path","description":"Comment ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Comment deleted"},"403":{"description":"Not comment owner"},"404":{"description":"Comment not found"}},"security":[{"bearer":[]}],"summary":"Delete comment (own comments only)","tags":["Comments"]},"get":{"operationId":"CommentController_findById","parameters":[{"name":"id","required":true,"in":"path","description":"Comment ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Comment found"},"404":{"description":"Comment not found"}},"security":[{"bearer":[]}],"summary":"Get comment by ID","tags":["Comments"]}},"/comments/process/{processId}":{"get":{"operationId":"CommentController_findByProcessId","parameters":[{"name":"processId","required":true,"in":"path","description":"Process ID","schema":{"type":"string"}},{"name":"includeInternal","required":false,"in":"query","description":"Include internal comments (default: true for staff, false for company)","schema":{"type":"boolean"}}],"responses":{"200":{"description":"Comments found"}},"security":[{"bearer":[]}],"summary":"Get all comments for a process","tags":["Comments"]}},"/comments/mentions/me":{"get":{"operationId":"CommentController_findMyMentions","parameters":[{"name":"limit","required":false,"in":"query","description":"Maximum number of comments to return (default: 50)","schema":{"type":"number"}}],"responses":{"200":{"description":"Comments found"}},"security":[{"bearer":[]}],"summary":"Get comments where current user is mentioned","tags":["Comments"]}},"/comments/user/{userId}":{"get":{"operationId":"CommentController_findByUser","parameters":[{"name":"userId","required":true,"in":"path","description":"User ID","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Maximum number of comments to return (default: 50)","schema":{"type":"number"}}],"responses":{"200":{"description":"Comments found"}},"security":[{"bearer":[]}],"summary":"Get comments by user","tags":["Comments"]}},"/auditor-allocation/process/{processId}/allocate":{"patch":{"operationId":"AuditorAllocationController_allocateAuditor","parameters":[{"name":"processId","required":true,"in":"path","description":"Process ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AllocateAuditorDto"}}}},"responses":{"200":{"description":"Auditor allocated successfully"},"400":{"description":"User is not an auditor"},"404":{"description":"Process or auditor not found"}},"security":[{"bearer":[]}],"summary":"Allocate auditor to certification process","tags":["Auditor Allocation"]}},"/auditor-allocation/process/{processId}/remove":{"patch":{"operationId":"AuditorAllocationController_removeAuditor","parameters":[{"name":"processId","required":true,"in":"path","description":"Process ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Auditor removed successfully"},"400":{"description":"Process has no auditor allocated"},"404":{"description":"Process not found"}},"security":[{"bearer":[]}],"summary":"Remove auditor from certification process","tags":["Auditor Allocation"]}},"/auditor-allocation/auditor/{auditorId}/processes":{"get":{"operationId":"AuditorAllocationController_findProcessesByAuditor","parameters":[{"name":"auditorId","required":true,"in":"path","description":"Auditor user ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Processes found"},"404":{"description":"Auditor not found"}},"security":[{"bearer":[]}],"summary":"Get all processes assigned to an auditor","tags":["Auditor Allocation"]}},"/auditor-allocation/auditors":{"get":{"operationId":"AuditorAllocationController_findAvailableAuditors","parameters":[{"name":"available","required":false,"in":"query","description":"Filter only available auditors (with capacity)","schema":{"type":"boolean"}},{"name":"skip","required":false,"in":"query","description":"Pagination offset (default: 0)","schema":{"minimum":0,"type":"number"}},{"name":"take","required":false,"in":"query","description":"Items per page (default: 50)","schema":{"minimum":1,"type":"number"}}],"responses":{"200":{"description":"Auditors list with workload information"}},"security":[{"bearer":[]}],"summary":"List all auditors with optional filters","tags":["Auditor Allocation"]}},"/auditor-allocation/auditor/{auditorId}/workload":{"get":{"operationId":"AuditorAllocationController_getAuditorWorkload","parameters":[{"name":"auditorId","required":true,"in":"path","description":"Auditor user ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Workload information including total, active, and completed processes"},"400":{"description":"User is not an auditor"},"404":{"description":"Auditor not found"}},"security":[{"bearer":[]}],"summary":"Get auditor's current workload","tags":["Auditor Allocation"]}},"/auditor-allocation/stats":{"get":{"operationId":"AuditorAllocationController_getAuditorStats","parameters":[],"responses":{"200":{"description":"Statistics including total auditors, allocations, and averages"}},"security":[{"bearer":[]}],"summary":"Get auditor allocation statistics","tags":["Auditor Allocation"]}},"/industrial-classification/groups":{"get":{"description":"Returns all active industrial groups. Use includeRelations=true to get complete taxonomy tree.","operationId":"IndustrialClassificationController_getAllGroups","parameters":[{"name":"includeRelations","required":false,"in":"query","description":"Include categories and subcategories (default: false)","schema":{"type":"boolean"}}],"responses":{"200":{"description":"List of industrial groups"}},"security":[{"bearer":[]}],"summary":"Get all industrial groups","tags":["Industrial Classification"]}},"/industrial-classification/groups/{code}":{"get":{"operationId":"IndustrialClassificationController_getGroupByCode","parameters":[{"name":"code","required":true,"in":"path","description":"Group code","schema":{"example":"FOOD","type":"string"}}],"responses":{"200":{"description":"Industrial group"},"404":{"description":"Group not found"}},"security":[{"bearer":[]}],"summary":"Get industrial group by code","tags":["Industrial Classification"]}},"/industrial-classification/groups/{groupCode}/categories":{"get":{"operationId":"IndustrialClassificationController_getCategoriesByGroup","parameters":[{"name":"groupCode","required":true,"in":"path","description":"Group code","schema":{"example":"FOOD","type":"string"}}],"responses":{"200":{"description":"List of categories"},"404":{"description":"Group not found"}},"security":[{"bearer":[]}],"summary":"Get all categories for a group","tags":["Industrial Classification"]}},"/industrial-classification/categories/{code}":{"get":{"operationId":"IndustrialClassificationController_getCategoryByCode","parameters":[{"name":"code","required":true,"in":"path","description":"Category code","schema":{"example":"DAIRY","type":"string"}}],"responses":{"200":{"description":"Industrial category"},"404":{"description":"Category not found"}},"security":[{"bearer":[]}],"summary":"Get industrial category by code","tags":["Industrial Classification"]}},"/industrial-classification/categories/{categoryCode}/subcategories":{"get":{"operationId":"IndustrialClassificationController_getSubcategoriesByCategory","parameters":[{"name":"categoryCode","required":true,"in":"path","description":"Category code","schema":{"example":"DAIRY","type":"string"}}],"responses":{"200":{"description":"List of subcategories"},"404":{"description":"Category not found"}},"security":[{"bearer":[]}],"summary":"Get all subcategories for a category","tags":["Industrial Classification"]}},"/industrial-classification/categories/{code}/audit-days":{"get":{"description":"Returns the estimated number of audit days required for this category","operationId":"IndustrialClassificationController_getAuditDays","parameters":[{"name":"code","required":true,"in":"path","description":"Category code","schema":{"example":"DAIRY","type":"string"}}],"responses":{"200":{"description":"Audit days estimate","content":{"application/json":{"schema":{"type":"object","properties":{"categoryCode":{"type":"string"},"auditDays":{"type":"number","nullable":true}}}}}},"404":{"description":"Category not found"}},"security":[{"bearer":[]}],"summary":"Get audit days estimate for a category","tags":["Industrial Classification"]}},"/industrial-classification/path":{"get":{"description":"Validates and returns the complete hierarchy for a classification","operationId":"IndustrialClassificationController_getClassificationPath","parameters":[{"name":"groupCode","required":true,"in":"query","description":"Group code","schema":{"example":"FOOD","type":"string"}},{"name":"categoryCode","required":true,"in":"query","description":"Category code","schema":{"example":"DAIRY","type":"string"}},{"name":"subcategoryCode","required":true,"in":"query","description":"Subcategory code","schema":{"example":"CHEESE","type":"string"}}],"responses":{"200":{"description":"Complete classification path"},"404":{"description":"Invalid classification - part of hierarchy not found"}},"security":[{"bearer":[]}],"summary":"Get complete classification path","tags":["Industrial Classification"]}},"/industrial-classification/validate":{"get":{"description":"Returns true if the group/category/subcategory chain exists","operationId":"IndustrialClassificationController_validateClassification","parameters":[{"name":"groupCode","required":true,"in":"query","description":"Group code","schema":{"example":"FOOD","type":"string"}},{"name":"categoryCode","required":true,"in":"query","description":"Category code","schema":{"example":"DAIRY","type":"string"}},{"name":"subcategoryCode","required":true,"in":"query","description":"Subcategory code","schema":{"example":"CHEESE","type":"string"}}],"responses":{"200":{"description":"Validation result","content":{"application/json":{"schema":{"type":"object","properties":{"valid":{"type":"boolean"},"groupCode":{"type":"string"},"categoryCode":{"type":"string"},"subcategoryCode":{"type":"string"}}}}}}},"security":[{"bearer":[]}],"summary":"Validate a classification combination","tags":["Industrial Classification"]}},"/health":{"get":{"operationId":"HealthController_check","parameters":[],"responses":{"200":{"description":"The Health Check is successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"ok"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}},"503":{"description":"The Health Check is not successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"error"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"},"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}}},"summary":"Health check endpoint","tags":["Health"]}},"/health/live":{"get":{"operationId":"HealthController_getLiveness","parameters":[],"responses":{"200":{"description":"Service is alive"}},"summary":"Liveness probe","tags":["Health"]}},"/health/ready":{"get":{"operationId":"HealthController_getReadiness","parameters":[],"responses":{"200":{"description":"Service is ready"}},"summary":"Readiness probe","tags":["Health"]}}},"info":{"title":"HalalSphere API","description":"Sistema de Gestão de Certificação Halal","version":"2.0.0","contact":{}},"tags":[],"servers":[{"url":"http://localhost:3333","description":"Local Development"},{"url":"https://api-staging.halalsphere.com","description":"Staging"},{"url":"https://api.halalsphere.com","description":"Production"}],"components":{"securitySchemes":{"access-token":{"scheme":"bearer","bearerFormat":"JWT","type":"http","description":"Enter JWT token","in":"header"}},"schemas":{"LoginDto":{"type":"object","properties":{"email":{"type":"string","example":"usuario@example.com","description":"Email do usuário"},"password":{"type":"string","example":"senha123","description":"Senha do usuário","minLength":6}},"required":["email","password"]},"LoginResponseDto":{"type":"object","properties":{}},"CompanyAddressDto":{"type":"object","properties":{"cep":{"type":"string"},"cidade":{"type":"string"},"uf":{"type":"string"},"logradouro":{"type":"string"},"numero":{"type":"string"},"complemento":{"type":"string"},"bairro":{"type":"string"},"pais":{"type":"string","default":"Brasil"}},"required":["cep","cidade","uf","pais"]},"CompanyContactDto":{"type":"object","properties":{"email":{"type":"string"},"telefone":{"type":"string"},"whatsapp":{"type":"string"},"responsavel":{"type":"string"}},"required":["email","telefone","responsavel"]},"CompanyDataDto":{"type":"object","properties":{"cnpj":{"type":"string"},"razaoSocial":{"type":"string"},"nomeFantasia":{"type":"string"},"address":{"$ref":"#/components/schemas/CompanyAddressDto"},"contact":{"$ref":"#/components/schemas/CompanyContactDto"},"website":{"type":"string"},"numEmployees":{"type":"number"},"annualRevenue":{"type":"number"},"mainActivity":{"type":"string"}},"required":["cnpj","razaoSocial","address","contact"]},"CreateUserDto":{"type":"object","properties":{"email":{"type":"string","example":"usuario@example.com"},"password":{"type":"string","example":"senha123","minLength":6},"name":{"type":"string","example":"João da Silva","minLength":3},"phone":{"type":"string","example":"+55 11 98765-4321"},"role":{"type":"string","enum":["admin","empresa","analista","auditor","gestor","comercial","juridico","financeiro","gestor_auditoria","supervisor","controlador","secretaria"],"example":"empresa"},"companyData":{"$ref":"#/components/schemas/CompanyDataDto"}},"required":["email","password","name","role"]},"UpdateUserDto":{"type":"object","properties":{"email":{"type":"string","example":"usuario@example.com"},"password":{"type":"string","example":"senha123","minLength":6},"name":{"type":"string","example":"João da Silva","minLength":3},"phone":{"type":"string","example":"+55 11 98765-4321"},"role":{"type":"string","enum":["admin","empresa","analista","auditor","gestor","comercial","juridico","financeiro","gestor_auditoria","supervisor","controlador","secretaria"],"example":"empresa"},"mfaEnabled":{"type":"boolean"},"loginAttempts":{"type":"number"},"lockedUntil":{"type":"object"}}},"CreateRequestDto":{"type":"object","properties":{"companyId":{"type":"string","description":"Company ID","format":"uuid"},"companyName":{"type":"string","description":"Company name","maxLength":255},"contactPerson":{"type":"string","description":"Contact person name","maxLength":255},"contactEmail":{"type":"string","description":"Contact email","format":"email","example":"contact@company.com"},"contactPhone":{"type":"string","description":"Contact phone number","example":"+55 11 99999-9999"},"requestType":{"type":"string","description":"Request type","enum":["nova","renovacao","ampliacao","inicial"],"example":"nova"},"certificationType":{"type":"string","description":"Certification type","enum":["C1","C2","C3","C4","C5","C6","produto","processo","servico"],"example":"C1"},"productDescription":{"type":"string","description":"Product description","example":"Halal certified frozen chicken products"},"productIngredients":{"type":"string","description":"Product ingredients list","example":"Chicken, salt, spices"},"facilityAddress":{"type":"string","description":"Facility address","example":"Rua Example, 123"},"facilityCity":{"type":"string","description":"Facility city","maxLength":100,"example":"São Paulo"},"facilityState":{"type":"string","description":"Facility state","maxLength":50,"example":"SP"},"facilityCountry":{"type":"string","description":"Facility country","maxLength":50,"example":"Brasil"},"facilityPostalCode":{"type":"string","description":"Facility postal code","maxLength":20,"example":"01234-567"},"previousCertificates":{"type":"boolean","description":"Has previous Halal certificates","default":false},"certifyingBody":{"type":"string","description":"Previous certifying body name","maxLength":255,"example":"Islamic Certification Body"},"certificateNumber":{"type":"string","description":"Previous certificate number","maxLength":100,"example":"HALAL-2023-001"},"certificateExpiry":{"format":"date-time","type":"string","description":"Previous certificate expiry date","example":"2025-12-31T23:59:59Z"},"industrialGroupId":{"type":"string","description":"Industrial group ID","format":"uuid"},"industrialCategoryId":{"type":"string","description":"Industrial category ID","format":"uuid"},"industrialSubcategoryId":{"type":"string","description":"Industrial subcategory ID","format":"uuid"},"numberOfEmployees":{"type":"number","description":"Number of employees","minimum":1,"example":50},"annualProduction":{"type":"string","description":"Annual production volume","example":"1000 tons/year"},"rawMaterialSuppliers":{"type":"number","description":"Number of raw material suppliers","minimum":0,"example":10},"additionalInfo":{"type":"string","description":"Additional information","example":"We follow strict Halal guidelines in all processes"}},"required":["companyId","companyName","contactPerson","contactEmail","contactPhone","requestType","certificationType","productDescription","facilityAddress","facilityCity","facilityState","facilityCountry","facilityPostalCode"]},"UpdateRequestDto":{"type":"object","properties":{"companyId":{"type":"string","description":"Company ID","format":"uuid"},"companyName":{"type":"string","description":"Company name","maxLength":255},"contactPerson":{"type":"string","description":"Contact person name","maxLength":255},"contactEmail":{"type":"string","description":"Contact email","format":"email","example":"contact@company.com"},"contactPhone":{"type":"string","description":"Contact phone number","example":"+55 11 99999-9999"},"requestType":{"type":"string","description":"Request type","enum":["nova","renovacao","ampliacao","inicial"],"example":"nova"},"certificationType":{"type":"string","description":"Certification type","enum":["C1","C2","C3","C4","C5","C6","produto","processo","servico"],"example":"C1"},"productDescription":{"type":"string","description":"Product description","example":"Halal certified frozen chicken products"},"productIngredients":{"type":"string","description":"Product ingredients list","example":"Chicken, salt, spices"},"facilityAddress":{"type":"string","description":"Facility address","example":"Rua Example, 123"},"facilityCity":{"type":"string","description":"Facility city","maxLength":100,"example":"São Paulo"},"facilityState":{"type":"string","description":"Facility state","maxLength":50,"example":"SP"},"facilityCountry":{"type":"string","description":"Facility country","maxLength":50,"example":"Brasil"},"facilityPostalCode":{"type":"string","description":"Facility postal code","maxLength":20,"example":"01234-567"},"previousCertificates":{"type":"boolean","description":"Has previous Halal certificates","default":false},"certifyingBody":{"type":"string","description":"Previous certifying body name","maxLength":255,"example":"Islamic Certification Body"},"certificateNumber":{"type":"string","description":"Previous certificate number","maxLength":100,"example":"HALAL-2023-001"},"certificateExpiry":{"format":"date-time","type":"string","description":"Previous certificate expiry date","example":"2025-12-31T23:59:59Z"},"industrialGroupId":{"type":"string","description":"Industrial group ID","format":"uuid"},"industrialCategoryId":{"type":"string","description":"Industrial category ID","format":"uuid"},"industrialSubcategoryId":{"type":"string","description":"Industrial subcategory ID","format":"uuid"},"numberOfEmployees":{"type":"number","description":"Number of employees","minimum":1,"example":50},"annualProduction":{"type":"string","description":"Annual production volume","example":"1000 tons/year"},"rawMaterialSuppliers":{"type":"number","description":"Number of raw material suppliers","minimum":0,"example":10},"additionalInfo":{"type":"string","description":"Additional information","example":"We follow strict Halal guidelines in all processes"}}},"ApproveRequestDto":{"type":"object","properties":{"reviewNotes":{"type":"string","description":"Review notes from analyst","example":"All documentation is complete and valid. Approved for processing."}}},"RejectRequestDto":{"type":"object","properties":{"rejectionReason":{"type":"string","description":"Reason for rejection","example":"Incomplete documentation"},"reviewNotes":{"type":"string","description":"Detailed review notes explaining the rejection","example":"The following documents are missing: Certificate of Slaughter, Ingredient declarations. Please resubmit with complete documentation."}},"required":["rejectionReason","reviewNotes"]},"CreateCompanyDto":{"type":"object","properties":{"razaoSocial":{"type":"string","description":"Legal company name (Razão Social)","maxLength":255,"example":"Halal Foods Ltda"},"nomeFantasia":{"type":"string","description":"Trade name (Nome Fantasia)","maxLength":255,"example":"Halal Foods"},"cnpj":{"type":"string","description":"Brazilian Tax ID (CNPJ) - format: 00.000.000/0000-00","example":"12.345.678/0001-90","pattern":"^\\d{2}\\.\\d{3}\\.\\d{3}/\\d{4}-\\d{2}$"},"email":{"type":"string","description":"Company email","format":"email","example":"contact@halalfoods.com"},"telefone":{"type":"string","description":"Company phone number","example":"+55 11 99999-9999"},"endereco":{"type":"string","description":"Company address","example":"Rua Example, 123, Suite 456"},"cidade":{"type":"string","description":"City","maxLength":100,"example":"São Paulo"},"estado":{"type":"string","description":"State","maxLength":50,"example":"SP"},"pais":{"type":"string","description":"Country","maxLength":50,"example":"Brasil","default":"Brasil"},"cep":{"type":"string","description":"Postal code (CEP)","maxLength":20,"example":"01234-567"},"website":{"type":"string","description":"Company website","format":"url","example":"https://www.halalfoods.com"},"inscricaoEstadual":{"type":"string","description":"State tax registration (Inscrição Estadual)","maxLength":50,"example":"123.456.789.012"},"inscricaoMunicipal":{"type":"string","description":"Municipal tax registration (Inscrição Municipal)","maxLength":50,"example":"123456789"}},"required":["razaoSocial","cnpj","email","telefone","endereco","cidade","estado","pais","cep"]},"UpdateCompanyDto":{"type":"object","properties":{"razaoSocial":{"type":"string","description":"Legal company name (Razão Social)","maxLength":255,"example":"Halal Foods Ltda"},"nomeFantasia":{"type":"string","description":"Trade name (Nome Fantasia)","maxLength":255,"example":"Halal Foods"},"email":{"type":"string","description":"Company email","format":"email","example":"contact@halalfoods.com"},"telefone":{"type":"string","description":"Company phone number","example":"+55 11 99999-9999"},"endereco":{"type":"string","description":"Company address","example":"Rua Example, 123, Suite 456"},"cidade":{"type":"string","description":"City","maxLength":100,"example":"São Paulo"},"estado":{"type":"string","description":"State","maxLength":50,"example":"SP"},"pais":{"type":"string","description":"Country","maxLength":50,"example":"Brasil","default":"Brasil"},"cep":{"type":"string","description":"Postal code (CEP)","maxLength":20,"example":"01234-567"},"website":{"type":"string","description":"Company website","format":"url","example":"https://www.halalfoods.com"},"inscricaoEstadual":{"type":"string","description":"State tax registration (Inscrição Estadual)","maxLength":50,"example":"123.456.789.012"},"inscricaoMunicipal":{"type":"string","description":"Municipal tax registration (Inscrição Municipal)","maxLength":50,"example":"123456789"}}},"VerifyCompanyDto":{"type":"object","properties":{"verificationNotes":{"type":"string","description":"Verification notes from admin","example":"Company documentation verified. CNPJ is valid and matches federal records."}}},"CreateProcessDto":{"type":"object","properties":{"requestType":{"type":"string","enum":["nova","renovacao","ampliacao","inicial"],"example":"nova","description":"Tipo de solicitação"},"certificationType":{"type":"string","enum":["C1","C2","C3","C4","C5","C6","produto","processo","servico"],"example":"halal","description":"Tipo de certificação"},"companyName":{"type":"string","example":"Empresa Exemplo Ltda"},"cnpj":{"type":"string","example":"12345678000190","minLength":14},"address":{"type":"string","example":"Rua Exemplo, 123"},"phone":{"type":"string","example":"+55 11 98765-4321"},"contactName":{"type":"string","example":"João Silva"},"contactEmail":{"type":"string","example":"joao@empresa.com"},"industrialGroup":{"type":"string","example":"C10","description":"Código do grupo industrial (GSO 2055-2)"},"industrialCategory":{"type":"string","example":"C10.5","description":"Código da categoria industrial"},"industrialSubcategory":{"type":"string","example":"C10.51","description":"Código da subcategoria industrial"},"productOrigin":{"type":"string","enum":["animal","vegetal","misto","quimico"],"example":"animal","description":"Origem do produto"},"productType":{"type":"string","example":"Alimentos"},"productDescription":{"type":"string","example":"Queijo artesanal produzido com leite integral","minLength":10},"productCategory":{"type":"string","example":"Lácteos"},"productionCapacity":{"type":"string","example":"1000 kg/dia"},"productionAddress":{"type":"string","example":"Rod. BR-101, KM 50"},"hasOtherCertifications":{"type":"boolean","example":true},"otherCertifications":{"type":"string","example":"ISO 9001, ISO 22000"},"ingredients":{"type":"string","example":"Leite, sal, culturas lácticas, coalho"},"suppliers":{"type":"string","example":"Fazenda São José, Laticínios ABC"},"hasAnimalIngredients":{"type":"boolean","example":true},"animalIngredientDetails":{"type":"string","example":"Leite de vaca integral"},"agreedToTerms":{"type":"boolean","example":true}},"required":["requestType","certificationType","companyName","cnpj","address","phone","contactName","contactEmail","industrialGroup","industrialCategory","industrialSubcategory","productOrigin","productType","productDescription","productCategory","productionCapacity","productionAddress","hasOtherCertifications","ingredients","suppliers","hasAnimalIngredients","agreedToTerms"]},"UpdateProcessStatusDto":{"type":"object","properties":{"status":{"type":"string","enum":["rascunho","pendente","em_andamento","aguardando_documentos","analise_documental","analise_tecnica","aguardando_auditoria","proposta_enviada","aguardando_assinatura","em_auditoria","concluido","aprovado","reprovado","certificado","cancelado","suspenso"],"example":"em_andamento","description":"Novo status do processo"},"notes":{"type":"string","example":"Documentação aprovada, avançando para próxima fase"}},"required":["status"]},"AssignAnalystDto":{"type":"object","properties":{"analystId":{"type":"string","example":"550e8400-e29b-41d4-a716-446655440000","description":"ID do analista a ser atribuído"},"priority":{"type":"string","enum":["baixa","media","alta","urgente"],"example":"media","description":"Prioridade do processo"}},"required":["analystId"]},"CalculationInputDto":{"type":"object","properties":{"certificationType":{"type":"string","enum":["C1","C2","C3","C4","C5","C6","produto","processo","servico"],"example":"C1","description":"Type of certification (C1-C6)"},"requestType":{"type":"string","enum":["nova","renovacao","ampliacao","inicial"],"example":"nova","description":"Type of request (nova, manutencao, adequacao)"},"numProducts":{"type":"number","example":15,"description":"Number of products to be certified","minimum":1},"numShifts":{"type":"number","example":2,"description":"Number of work shifts (1-3)","minimum":1,"maximum":3},"numSuppliers":{"type":"number","example":5,"description":"Number of suppliers","minimum":0},"numEmployees":{"type":"number","example":75,"description":"Number of employees","minimum":1},"distance":{"type":"number","example":250,"description":"Distance to company location (km)","minimum":0},"requiresAccommodation":{"type":"boolean","example":true,"description":"Whether accommodation is required for auditors"}},"required":["certificationType","requestType","numProducts","numShifts","numSuppliers","numEmployees","distance","requiresAccommodation"]},"CreateProposalDto":{"type":"object","properties":{"processId":{"type":"string","example":"550e8400-e29b-41d4-a716-446655440000","description":"Process ID to create proposal for"},"calculationInputs":{"description":"Calculation input parameters","allOf":[{"$ref":"#/components/schemas/CalculationInputDto"}]}},"required":["processId","calculationInputs"]},"AdjustProposalDto":{"type":"object","properties":{"manualAdjustment":{"type":"number","example":-500,"description":"Manual adjustment amount (can be positive or negative). Added to calculated value."},"adjustmentReason":{"type":"string","example":"Desconto comercial aprovado pelo coordenador","description":"Reason for the adjustment (required for audit trail)"}},"required":["manualAdjustment","adjustmentReason"]},"RespondProposalDto":{"type":"object","properties":{"accepted":{"type":"boolean","example":true,"description":"Whether the proposal is accepted (true) or rejected (false)"},"responseNotes":{"type":"string","example":"Proposta aceita. Aguardamos o contrato.","description":"Optional notes from the company about their decision"}},"required":["accepted"]},"CreatePricingTableDto":{"type":"object","properties":{"version":{"type":"string","example":"v1.0","description":"Version identifier (e.g., v1.0, v1.1)"},"effectiveFrom":{"format":"date-time","type":"string","example":"2026-01-15T00:00:00.000Z","description":"Date from which this pricing table becomes effective"},"country":{"type":"string","example":"BR","description":"Country for this pricing table"},"currency":{"type":"string","example":"BRL","description":"Currency for all prices in this table"},"basePrices":{"type":"object","example":{"C1":5000,"C2":6000,"C3":7000,"C4":8000,"C5":9000,"C6":10000},"description":"Base prices for each certification type (C1-C6)"},"productMultipliers":{"type":"object","example":{"1-10":1,"11-50":1.3,"51-100":1.6,"100+":2},"description":"Product count multipliers"},"shiftMultipliers":{"type":"object","example":{"1":1,"2":1.4,"3":1.8},"description":"Shift count multipliers"},"historyMultipliers":{"type":"object","example":{"nova":1,"manutencao":0.8,"adequacao":0.9},"description":"Request type/history multipliers"},"supplierMultipliers":{"type":"object","example":{"1-5":1,"6-15":1.2,"16+":1.5},"description":"Supplier count multipliers"},"manHourRates":{"type":"object","example":{"1-50":{"hours":8,"rate":150},"51-150":{"hours":16,"rate":150},"151-300":{"hours":24,"rate":150},"300+":{"hours":32,"rate":150}},"description":"Man-hour rates by employee count ranges"},"travelCosts":{"type":"object","example":{"0-100":200,"100-300":500,"300-500":800,"500+":1200},"description":"Travel costs by distance ranges (km)"},"accommodationCost":{"type":"number","example":300,"description":"Accommodation cost per night (if required)","minimum":0},"documentAnalysisFee":{"type":"number","example":800,"description":"Document analysis fee (fixed)","minimum":0},"committeeFee":{"type":"number","example":1200,"description":"Technical committee review fee (fixed)","minimum":0},"issuanceFee":{"type":"number","example":500,"description":"Certificate issuance fee (fixed)","minimum":0},"taxRate":{"type":"number","example":15,"description":"Tax rate as percentage (e.g., 15 for 15%)","minimum":0,"maximum":100}},"required":["version","effectiveFrom","basePrices","productMultipliers","shiftMultipliers","historyMultipliers","supplierMultipliers","manHourRates","travelCosts","accommodationCost","documentAnalysisFee","committeeFee","issuanceFee","taxRate"]},"UpdatePricingTableDto":{"type":"object","properties":{"effectiveFrom":{"format":"date-time","type":"string","example":"2026-01-15T00:00:00.000Z","description":"Date from which this pricing table becomes effective"},"country":{"type":"string","example":"BR","description":"Country for this pricing table"},"currency":{"type":"string","example":"BRL","description":"Currency for all prices in this table"},"basePrices":{"type":"object","example":{"C1":5000,"C2":6000,"C3":7000,"C4":8000,"C5":9000,"C6":10000},"description":"Base prices for each certification type (C1-C6)"},"productMultipliers":{"type":"object","example":{"1-10":1,"11-50":1.3,"51-100":1.6,"100+":2},"description":"Product count multipliers"},"shiftMultipliers":{"type":"object","example":{"1":1,"2":1.4,"3":1.8},"description":"Shift count multipliers"},"historyMultipliers":{"type":"object","example":{"nova":1,"manutencao":0.8,"adequacao":0.9},"description":"Request type/history multipliers"},"supplierMultipliers":{"type":"object","example":{"1-5":1,"6-15":1.2,"16+":1.5},"description":"Supplier count multipliers"},"manHourRates":{"type":"object","example":{"1-50":{"hours":8,"rate":150},"51-150":{"hours":16,"rate":150},"151-300":{"hours":24,"rate":150},"300+":{"hours":32,"rate":150}},"description":"Man-hour rates by employee count ranges"},"travelCosts":{"type":"object","example":{"0-100":200,"100-300":500,"300-500":800,"500+":1200},"description":"Travel costs by distance ranges (km)"},"accommodationCost":{"type":"number","example":300,"description":"Accommodation cost per night (if required)","minimum":0},"documentAnalysisFee":{"type":"number","example":800,"description":"Document analysis fee (fixed)","minimum":0},"committeeFee":{"type":"number","example":1200,"description":"Technical committee review fee (fixed)","minimum":0},"issuanceFee":{"type":"number","example":500,"description":"Certificate issuance fee (fixed)","minimum":0},"taxRate":{"type":"number","example":15,"description":"Tax rate as percentage (e.g., 15 for 15%)","minimum":0,"maximum":100}}},"CreateAuditDto":{"type":"object","properties":{"processId":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000","description":"Process ID to audit"},"auditType":{"type":"string","enum":["estagio1","estagio2","vigilancia","especial"],"example":"estagio1","description":"Type of audit: estagio1 (initial), estagio2 (follow-up), vigilancia (surveillance), especial (special)"},"scheduledDate":{"format":"date-time","type":"string","example":"2026-02-15T10:00:00.000Z","description":"Scheduled date and time for the audit"},"location":{"type":"object","example":{"tipo":"presencial","endereco":"Rua Example, 123, São Paulo, SP"},"description":"Location details: {tipo: \"presencial\"|\"remota\", endereco?: string}"},"auditorNotes":{"type":"string","example":"Auditoria inicial para certificação C1","description":"Initial notes about the audit"}},"required":["processId","auditType","scheduledDate","location"]},"UpdateAuditDto":{"type":"object","properties":{"scheduledDate":{"format":"date-time","type":"string","example":"2026-02-20T14:00:00.000Z","description":"Rescheduled date and time"},"location":{"type":"object","example":{"tipo":"remota","endereco":null},"description":"Updated location details"},"auditorNotes":{"type":"string","example":"Auditoria remota devido a distância","description":"Updated notes"}}},"StartAuditDto":{"type":"object","properties":{"auditorNotes":{"type":"string","example":"Iniciando auditoria conforme planejado","description":"Notes when starting the audit"}}},"CompleteAuditDto":{"type":"object","properties":{"findings":{"type":"object","example":{"conformidades":["Instalações adequadas para produção Halal","Documentação de fornecedores em ordem"],"nao_conformidades":[{"item":"Falta de segregação entre produtos Halal e não-Halal","gravidade":"maior","acao_corretiva":"Implementar área separada até 15/03/2026"}]},"description":"Audit findings with conformities and non-conformities: {conformidades: string[], nao_conformidades: Array<{item, gravidade, acao_corretiva}>}"},"auditorNotes":{"type":"string","example":"Auditoria concluída. Identificada 1 não-conformidade maior que requer ação corretiva.","description":"Final notes from auditor"}},"required":["findings"]},"FinalizeAuditDto":{"type":"object","properties":{"result":{"type":"string","enum":["aprovado","aprovado_condicional","reprovado"],"example":"aprovado","description":"Audit result: aprovado (approved), aprovado_condicional (conditionally approved), reprovado (rejected)"},"auditorNotes":{"type":"string","example":"Processo aprovado após verificação das ações corretivas implementadas.","description":"Justification for the decision"}},"required":["result"]},"CancelAuditDto":{"type":"object","properties":{"reason":{"type":"string","description":"Motivo do cancelamento","example":"Cliente solicitou reagendamento"}},"required":["reason"]},"CreateContractDto":{"type":"object","properties":{"processId":{"type":"string","description":"ID do processo de certificação","example":"123e4567-e89b-12d3-a456-426614174000"},"companyId":{"type":"string","description":"ID da empresa","example":"123e4567-e89b-12d3-a456-426614174001"},"contractType":{"type":"string","description":"Tipo de contrato","enum":["proposta","contrato"],"example":"contrato"},"totalValue":{"type":"number","description":"Valor total do contrato","example":15000,"minimum":0},"numInstallments":{"type":"number","description":"Número de parcelas","example":12,"minimum":1,"maximum":24},"validityMonths":{"type":"number","description":"Período de validade do contrato em meses","example":12,"minimum":1,"maximum":60},"pdfUrl":{"type":"string","description":"URL do PDF do contrato (opcional)","example":"https://storage.example.com/contracts/contract-2024-001.pdf"}},"required":["processId","companyId","contractType","totalValue","numInstallments","validityMonths"]},"UpdateContractDto":{"type":"object","properties":{"numInstallments":{"type":"number","description":"Número de parcelas","example":12,"minimum":1,"maximum":24},"validityMonths":{"type":"number","description":"Período de validade do contrato em meses","example":12,"minimum":1,"maximum":60},"totalValue":{"type":"number","description":"Valor total do contrato","example":15000,"minimum":0},"pdfUrl":{"type":"string","description":"URL do PDF do contrato","example":"https://storage.example.com/contracts/contract-2024-001.pdf"}}},"SignContractDto":{"type":"object","properties":{"signedAt":{"format":"date-time","type":"string","description":"Data e hora da assinatura do contrato","example":"2024-01-15T10:30:00Z"}},"required":["signedAt"]},"CancelContractDto":{"type":"object","properties":{"reason":{"type":"string","description":"Motivo do cancelamento (opcional)","example":"Cliente desistiu da certificação"}}},"CreateDocumentRequestDto":{"type":"object","properties":{"processId":{"type":"string","description":"ID do processo","example":"123e4567-e89b-12d3-a456-426614174000"},"documentType":{"type":"string","description":"Tipo de documento","enum":["contrato_social","certidao_negativa","alvara_funcionamento","laudo_tecnico","licenca_sanitaria","fotos","videos","laudos","manual_bpf","fluxograma_processo","lista_fornecedores","certificado_ingredientes","analise_produto","rotulo_produto","outros"]},"description":{"type":"string","description":"Descrição da solicitação","example":"Enviar contrato social atualizado"},"dueDate":{"format":"date-time","type":"string","description":"Data limite para envio"}},"required":["processId","documentType","description"]},"UpdateDocumentRequestDto":{"type":"object","properties":{"description":{"type":"string","description":"Descrição da solicitação"},"dueDate":{"format":"date-time","type":"string","description":"Data limite para envio"}}},"FulfillDocumentRequestDto":{"type":"object","properties":{"uploadedDocId":{"type":"string","description":"ID do documento enviado","example":"123e4567-e89b-12d3-a456-426614174000"}},"required":["uploadedDocId"]},"CreateCommentDto":{"type":"object","properties":{"processId":{"type":"string","description":"ID do processo ao qual o comentário pertence","example":"123e4567-e89b-12d3-a456-426614174000"},"content":{"type":"string","description":"Conteúdo do comentário","example":"Documentação aprovada, processo pode avançar para próxima fase","minLength":1},"mentions":{"description":"IDs dos usuários mencionados no comentário (@mentions)","example":["user-id-1","user-id-2"],"type":"array","items":{"type":"string"}},"isInternal":{"type":"boolean","description":"Se true, comentário é interno (visível apenas para equipe). Se false, visível para empresa também.","example":false,"default":false}},"required":["processId","content"]},"UpdateCommentDto":{"type":"object","properties":{"content":{"type":"string","description":"Conteúdo atualizado do comentário","example":"Documentação aprovada após correções","minLength":1},"mentions":{"description":"IDs atualizados dos usuários mencionados","example":["user-id-1","user-id-3"],"type":"array","items":{"type":"string"}},"isInternal":{"type":"boolean","description":"Atualizar visibilidade do comentário","example":true}}},"AllocateAuditorDto":{"type":"object","properties":{"auditorId":{"type":"string","description":"ID do auditor a ser alocado ao processo","example":"123e4567-e89b-12d3-a456-426614174000"}},"required":["auditorId"]}}}}